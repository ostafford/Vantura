import{j as e,E as A,Q as F}from"./endpoints-s3-HOZU7.js";import{r as o}from"./application-BYD5QzVF.js";import{u as M,a as O}from"./useFilters-BQjZ5U-6.js";function T({filterId:i,initialFilter:l,availableCategories:N=[],availableMerchants:_=[],availableStatuses:w=[],onSuccess:h,onCancel:p}){const f=M(),k=O(),[m,C]=o.useState((l==null?void 0:l.name)||""),[d,j]=o.useState((l==null?void 0:l.filter_types)||[]),[t,c]=o.useState((l==null?void 0:l.filter_params)||{}),[g,S]=o.useState("current_month"),[x,D]=o.useState(""),[y,E]=o.useState(""),[n,u]=o.useState({}),v=!!i,R=(r,a)=>{if(a)j([...d,r]);else{j(d.filter(b=>b!==r));const s={...t};r==="category"&&delete s.categories,r==="merchant"&&delete s.merchants,r==="status"&&delete s.statuses,r==="recurring_transactions"&&delete s.recurring_transactions,c(s)}},P=async r=>{if(r.preventDefault(),u({}),!m.trim()){u({name:"Filter name is required"});return}if(d.length===0){u({filter_types:"At least one filter type must be selected"});return}const a={};d.includes("category")&&t.categories&&(a.categories=t.categories),d.includes("merchant")&&t.merchants&&(a.merchants=t.merchants),d.includes("status")&&t.statuses&&(a.statuses=t.statuses),d.includes("recurring_transactions")&&t.recurring_transactions&&(a.recurring_transactions=t.recurring_transactions);let s=null;g==="custom"&&x&&y?s={start_date:x,end_date:y}:g!=="custom"&&(s=null);try{v&&i?await k.mutateAsync({id:i,params:{filter:{name:m,filter_types:d,filter_params:a,date_range:s}}}):await f.mutateAsync({filter:{name:m,filter_types:d,filter_params:a,date_range:s}}),h?h():window.location.reload()}catch(b){console.error("Failed to save filter:",b),u({submit:"Failed to save filter. Please try again."})}};return e.jsx("form",{onSubmit:P,className:"p-6",children:e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-name",className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Filter Name"}),e.jsx("input",{type:"text",id:"filter-name",value:m,onChange:r=>C(r.target.value),required:!0,className:`w-full px-4 py-3 border-2 rounded-lg focus:ring-2 focus:ring-primary-700 focus:border-primary-700 dark:focus:border-primary-500 transition-all ${n.name?"border-red-500":"border-gray-200 dark:border-gray-600"} bg-gray-50 dark:bg-primary-900 text-gray-900 dark:text-white`,placeholder:"e.g., High Value Expenses"}),n.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:n.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:"Filter Types"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:"Select one or more filter types to combine"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["category","merchant","status","recurring_transactions"].map(r=>e.jsxs("label",{className:"flex items-center p-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-primary-900 transition-all",children:[e.jsx("input",{type:"checkbox",checked:d.includes(r),onChange:a=>R(r,a.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 capitalize",children:r.replace("_"," ")})]},r))}),n.filter_types&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:n.filter_types})]}),e.jsxs("div",{id:"filter-params",className:"space-y-4",children:[d.includes("category")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Categories"}),e.jsx("select",{multiple:!0,value:t.categories||[],onChange:r=>{const a=Array.from(r.target.selectedOptions,s=>s.value);c({...t,categories:a})},className:"w-full px-4 py-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-primary-900 text-gray-900 dark:text-white",size:5,children:N.map(r=>e.jsx("option",{value:r,children:r.replace(/_/g," ")},r))}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Hold Ctrl/Cmd to select multiple"})]}),d.includes("merchant")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Merchants"}),e.jsx("select",{multiple:!0,value:t.merchants||[],onChange:r=>{const a=Array.from(r.target.selectedOptions,s=>s.value);c({...t,merchants:a})},className:"w-full px-4 py-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-primary-900 text-gray-900 dark:text-white",size:5,children:_.map(r=>e.jsx("option",{value:r,children:r},r))}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Hold Ctrl/Cmd to select multiple"})]}),d.includes("status")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Statuses"}),e.jsx("select",{multiple:!0,value:t.statuses||[],onChange:r=>{const a=Array.from(r.target.selectedOptions,s=>s.value);c({...t,statuses:a})},className:"w-full px-4 py-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-primary-900 text-gray-900 dark:text-white",children:w.map(r=>e.jsx("option",{value:r,children:r},r))})]}),d.includes("recurring_transactions")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Recurring Transactions"}),e.jsxs("select",{value:t.recurring_transactions||"both",onChange:r=>{c({...t,recurring_transactions:r.target.value})},className:"w-full px-4 py-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-primary-900 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"true",children:"From Recurring Only"}),e.jsx("option",{value:"false",children:"Non-Recurring Only"}),e.jsx("option",{value:"both",children:"Both"})]})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-200 mb-3",children:"Date Range (Optional)"}),e.jsxs("select",{value:g,onChange:r=>S(r.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-primary-900 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"current_month",children:"Current Month"}),e.jsx("option",{value:"last_month",children:"Last Month"}),e.jsx("option",{value:"3_months",children:"3 Months"}),e.jsx("option",{value:"6_months",children:"6 Months"}),e.jsx("option",{value:"custom",children:"Custom Range"})]}),g==="custom"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:x,onChange:r=>D(r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:y,onChange:r=>E(r.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]})]}),n.submit&&e.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-800 dark:text-red-300",children:n.submit})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",disabled:f.isPending||k.isPending,className:"flex-1 bg-gradient-to-r from-primary-700 to-primary-500 hover:from-primary-900 hover:to-primary-700 text-white px-5 py-3 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all disabled:opacity-50",children:v?"Update Filter":"Save Filter"}),p&&e.jsx("button",{type:"button",onClick:p,className:"px-5 py-3 bg-white dark:bg-primary-950 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-primary-900 font-semibold transition-all",children:"Cancel"})]})})]})})}function B(i){return e.jsx(A,{children:e.jsx(F,{children:e.jsx(T,{...i})})})}export{B as default};
//# sourceMappingURL=FilterForm-uTZavvFp.js.map
