import{u as A,b,j as e,E as T,Q as L}from"./endpoints-s3-HOZU7.js";import{r as g}from"./application-BYD5QzVF.js";import{g as D,t as R,d as S}from"./recurring-C8Szns6G.js";import{u as P}from"./useResponsive-BKikIpIw.js";function M(){return A(["recurring-transactions"],()=>D(),{staleTime:1e3*60*5})}function $(){return b(s=>R(s),{onSuccess:()=>{}})}function q(){return b(s=>S(s),{onSuccess:()=>{}})}function B({}){var k;const{data:s,isLoading:N,error:w}=M(),x=$(),m=q(),[l,_]=g.useState("next_occurrence"),[i,h]=g.useState("asc"),{isMobile:C}=P(),p=((k=s==null?void 0:s.data)==null?void 0:k.recurring_transactions)||[],u=g.useMemo(()=>[...p].sort((r,d)=>{let a,n;switch(l){case"description":a=r.description.toLowerCase(),n=d.description.toLowerCase();break;case"amount":a=r.amount,n=d.amount;break;case"frequency":a=r.frequency,n=d.frequency;break;case"next_occurrence":a=new Date(r.next_occurrence_date).getTime(),n=new Date(d.next_occurrence_date).getTime();break;case"status":a=r.is_active,n=d.is_active;break;default:return 0}return a<n?i==="asc"?-1:1:a>n?i==="asc"?1:-1:0}),[p,l,i]),c=t=>{l===t?h(i==="asc"?"desc":"asc"):(_(t),h("asc"))},y=async t=>{try{await x.mutateAsync(t)}catch(r){console.error("Failed to toggle active status:",r)}},f=async t=>{if(confirm("Delete this recurring pattern? All future projected transactions will be removed."))try{await m.mutateAsync(t)}catch(r){console.error("Failed to delete recurring transaction:",r)}},v=t=>`${t<0?"-":"+"}$${Math.abs(t).toFixed(2)}`,j=t=>t.charAt(0).toUpperCase()+t.slice(1),o=({column:t})=>l!==t?null:e.jsx("svg",{className:`w-4 h-4 ml-1 ${i==="asc"?"":"transform rotate-180"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 15l7-7 7 7"})});return N?e.jsxs("div",{className:"px-6 py-12 text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Loading recurring transactions..."})]}):w?e.jsx("div",{className:"px-6 py-12 text-center",children:e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:"Error loading recurring transactions"})}):u.length===0?e.jsxs("div",{className:"px-6 py-12 text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:"No recurring patterns"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Mark transactions as recurring to see them here."})]}):C?e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:u.map(t=>e.jsxs("div",{className:`p-4 ${t.is_active?"":"bg-gray-100 dark:bg-gray-700 opacity-60"} hover:bg-gray-50 dark:hover:bg-gray-700`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.description}),t.merchant_pattern&&e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:['Pattern: "',t.merchant_pattern,'" (±$',t.amount_tolerance||0,")"]})]}),e.jsx("span",{className:`text-sm font-medium ${t.amount<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:v(t.amount)})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:j(t.frequency)}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Next: ",new Date(t.next_occurrence_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),t.is_active?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"Paused"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y(t.id),disabled:x.isPending,className:"inline-flex items-center px-3 py-1 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 hover:shadow-md transition-all text-xs font-medium disabled:opacity-50",children:t.is_active?"Pause":"Resume"}),e.jsx("button",{onClick:()=>f(t.id),disabled:m.isPending,className:"inline-flex items-center px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 hover:shadow-md transition-all text-xs font-medium disabled:opacity-50",children:"Delete"})]})]})]},t.id))}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>c("description"),children:e.jsxs("div",{className:"flex items-center",children:["Description",e.jsx(o,{column:"description"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>c("amount"),children:e.jsxs("div",{className:"flex items-center",children:["Amount",e.jsx(o,{column:"amount"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>c("frequency"),children:e.jsxs("div",{className:"flex items-center",children:["Frequency",e.jsx(o,{column:"frequency"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>c("next_occurrence"),children:e.jsxs("div",{className:"flex items-center",children:["Next Occurrence",e.jsx(o,{column:"next_occurrence"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",onClick:()=>c("status"),children:e.jsxs("div",{className:"flex items-center",children:["Status",e.jsx(o,{column:"status"})]})}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:u.map(t=>e.jsxs("tr",{className:`hover:bg-gray-50 dark:hover:bg-gray-700 ${t.is_active?"":"bg-gray-100 dark:bg-gray-700 opacity-60"}`,children:[e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900 dark:text-gray-300",children:[t.description,t.merchant_pattern&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:['Pattern: "',t.merchant_pattern,'" (±$',t.amount_tolerance||0,")"]})]}),e.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium ${t.amount<0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:v(t.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:j(t.frequency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(t.next_occurrence_date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.is_active?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"Paused"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs("button",{onClick:()=>y(t.id),disabled:x.isPending,className:"inline-flex items-center px-3 py-1 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 hover:shadow-md hover:scale-105 transition-all text-xs font-medium disabled:opacity-50",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.is_active?"Pause":"Resume"]}),e.jsxs("button",{onClick:()=>f(t.id),disabled:m.isPending,className:"inline-flex items-center px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 hover:shadow-md hover:scale-105 transition-all text-xs font-medium disabled:opacity-50",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]})})]},t.id))})]})})}function Q(s){return e.jsx(T,{children:e.jsx(L,{children:e.jsx(B,{...s})})})}export{Q as default};
//# sourceMappingURL=RecurringTransactionTable-DX-UNrgR.js.map
